syntax = "proto3";

package api.freshkeep.v1;

import "google/api/annotations.proto";

option go_package = "github.com/freshkeep/backend/api/freshkeep/v1;v1";

// Image service definition
service ImageService {
  // RecognizeItem recognizes an item from an image
  rpc RecognizeItem (RecognizeItemRequest) returns (RecognizeItemReply) {
    option (google.api.http) = {
      post: "/api/v1/image/recognize"
      body: "*"
    };
  }

  // ExtractDate extracts expiration date from an image using OCR
  rpc ExtractDate (ExtractDateRequest) returns (ExtractDateReply) {
    option (google.api.http) = {
      post: "/api/v1/image/extract-date"
      body: "*"
    };
  }
}

message RecognizeItemRequest {
  bytes image_data = 1; // Base64 encoded image
  string content_type = 2;
}

message RecognizeItemReply {
  string item_name = 1;
  string category = 2;
  float confidence = 3;
  bool found = 4;
}

message ExtractDateRequest {
  bytes image_data = 1; // Base64 encoded image
  string content_type = 2;
}

message ExtractDateReply {
  int64 expiry_date = 1; // Unix timestamp, 0 if not found
  string date_text = 2; // Raw text extracted
  bool found = 3;
}

